---
layout: post
title: Mac下为bash设置代理
tags: osx Bash
categories: Mac环境
---

在Mac下时使用Bash时，注意默认情况下不会使用网络的代理，需要单独设置代理，否则对于被墙的资源只能呵呵呵了，有三种方案，一是在设置各使用软件源的国内镜像，二时设置软件的访问代理，三是直接在bash中设置代理。因为各个软件代理设置不一样，需要一个个的设置比较麻烦，国内的一些软件源镜像又不完整，所以最直接有效的版本就是设置Bash的访问代理。


## 1. 寻找可用的Http代理   

这个不用说，开发必备的翻墙技能

## 2. 设置Bash命令的代理   

	{% highlight bash %}  

    #proxy 
    LANTERN=127.0.0.1:8787
    COW=127.0.0.1:8118
    defp=$COW

    # No Proxy
    function noproxy
    {
        unset http_proxy HTTP_PROXY https_proxy HTTPS_PROXY all_proxy ALL_PROXY ftp_proxy FTP_PROXY dns_proxy DNS_PROXY JAVA_OPTS GRADLE_OPTS MAVEN_OPTS
        echo "clear proxy done"
    }


    function setproxy
    {
        if [ $# -eq 0 ]
        then
            inArg=$defp
        else
            inArg=$1
        fi
        HOST=$(echo $inArg |cut -d: -f1)
        PORT=$(echo $inArg |cut -d: -f2)
        http_proxy=http://$HOST:$PORT
        HTTP_PROXY=$http_proxy
        all_proxy=$http_proxy
        ALL_PROXY=$http_proxy
        ftp_proxy=$http_proxy
        FTP_PROXY=$http_proxy
        dns_proxy=$http_proxy
        DNS_PROXY=$http_proxy
        https_proxy=$http_proxy
        HTTPS_PROXY=$https_proxy
        JAVA_OPTS="-Dhttp.proxyHost=$HOST -Dhttp.proxyPort=$PORT -Dhttps.proxyHost=$HOST -Dhttps.proxyPort=$PORT"
        GRADLE_OPTS="-Dgradle.user.home=$HOME/.gradle"
        MAVEN_OPTS=$JAVA_OPTS
        no_proxy="localhost,127.0.0.1,localaddress,.localdomain.com,.coding.net,192.168.99.100,.ruby-china.org"
        echo "current proxy is ${http_proxy}"
        export no_proxy http_proxy HTTP_PROXY https_proxy HTTPS_PROXY all_proxy ALL_PROXY ftp_proxy FTP_PROXY dns_proxy DNS_PROXY JAVA_OPTS GRADLE_OPTS MAVEN_OPTS
    }

    setproxy
	{% endhighlight %}
    
这样常用软件的代理都设置好了，如果不想使用代理可以在bash中直接输入noproxy,想设置代理可以输入setproxy

## 3. 补充ShadowSocks转http代理    

目前大家可能会使用shadowsocks作为翻墙的工具，无奈Shadowsocks走的socket协议，不是一般的http代理所以这个需要使用工具转一下。    
转换工具：Privoxy    
安装Privoxy：brew install Privoxy    
#### 设置Prioxy
配置路径：/usr/local/etc/privoxy/config   
配置：  
>forward-socks5t   /               127.0.0.1:1080 .   
>listen-address 0.0.0.0:8118    

#### 启动Prixoy
    `brew services start privoxy`

#### 检查启动
`netstat -nat | grep '8118'`   
`tcp4       0      0  *.8118                 *.*                    LISTEN  `

